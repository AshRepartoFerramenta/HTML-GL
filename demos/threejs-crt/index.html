<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cyber text generator</title>
    <link rel="stylesheet" href="style/styles.css"/>
    <script src="https://unpkg.com/vue"></script>
</head>
<body>
<div id="app">
    <h1>CyberText</h1>
    <h2>Post to social networks cyberpunk style</h2>
    <input tupe="text" id="textInput" value="Hello world!</br>I am a cybertext.">
    <div class="inputRow">
        <label for="textColor">Text color</label>
        <input type="color" id="textColor" value="#c4e3f3">
    </div>
    <div class="inputRow">
        <label for="backgroundColor">Background color</label>
        <input type="color" id="backgroundColor" value="#000000">
    </div>
    <iframe id="recordingCanvas" border="0" src="./canvas.html" width="500" height="250"></iframe>
    <button id="record" onclick="record()">{{recordButtonLabel}}</button>

    <div class="preview">
        <p>Preview</p>
    </div>


</div>
</body>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            recordButtonLabel: 'Record'
        }
    });

    var doc;
    window.onload = function () {
        var frameElement = document.getElementById("recordingCanvas");
        doc = frameElement.contentDocument;

        var input = document.getElementById("textInput");
        input.addEventListener('keydown', updateText);

        var textColor = document.getElementById("textColor");
        textColor.addEventListener('change', changeTextColor);

        var textColor = document.getElementById("backgroundColor");
        textColor.addEventListener('change', changeBackgroundColor);
    };

    function updateText(e) {
        var text = doc.getElementById('text');
        text.innerHTML = e.target.value;
    }

    function record() {
        app.recordButtonLabel = 'Recording...';
        setTimeout(function(){
            var frameElement = document.getElementById("recordingCanvas");
            w = frameElement.contentWindow;
            w.record().then(recordingFinished);
        }, 0);
    }

    function recordingFinished() {
        app.recordButtonLabel = 'Record';
    }

    function changeTextColor(e) {
        var frameElement = document.getElementById("recordingCanvas");
        w = frameElement.contentWindow;
        w.changeTextColor(e.target.value);
    }

    function changeBackgroundColor(e) {
        var frameElement = document.getElementById("recordingCanvas");
        w = frameElement.contentWindow;
        w.changeBackgroundColor(e.target.value);
    }
</script>
</html>